# 第三次作业

- 何泽欣（18231070）
- 许卜仁（18231111）
- 胡雪瑜（18231094）

## 一种基于python元胞自动机的COVID-19在大不列颠岛流行情况的仿真方案

### 摘要

​		本文通过自主研发的python元胞自动机，对COVID-19在英国大不列颠岛的传播进行仿真。为此，模拟了人口在大不列颠岛的随机流动，将人的状态转移条件与人口间的相互接触联系起来，并探究了英国“群体免疫”策略的可行性。

**关键词：** 元胞自动机  SEIR模型 COVID-19

### 问题分析

​		本文通过元胞自动机仿真来得到长时间状态下COVID-19传播的可能稳定情况，进而分析治愈率、死亡率以及隔离措施对疫情传播的影响。为此，在第一问使用SEIR模型，配置不同的传染率参数，得到传染率与整个城市居民的感染人数之间的关系。第二问沿用第一问的模型，设定人口感染比例的临界值，低于最低临界值将被视为疾病基本消失，高于最大临界值被认为几乎所有人都会染病。在第三文中增加人的死亡状态，转变为SEIRD模型，并分析治愈率, 死亡率, 以及隔离措施对上面两个问题的影响。

主要影响因素：

* 总人口P
* 接触率
* 易感者与一个感染者接触单位时间后成为潜伏者的概率α1
* 易感者与一个潜伏者接触单位时间后成为潜伏者的概率α2
* 潜伏者单位时间内变为感染者的概率β
* 感染者单位时间内被治愈的概率θ
* 感染者单位时间内死亡的概率γ



**文献综述**：

文献[1]运用修正的SEIR传染病动力学模型对湖北省COVID-19疫情进行预测和评估。本文借鉴其中的经典SEIR模型并参考文献[1]中的模型参数。

### 假设

1. 在一个二维空间内，共有P个人，人口具有有明确的活动范围，人口在活动范围内随机流动。
2. 这P个人具有的状态可能为易感者S，潜伏者E，感染者I，免疫者R和死者D
   * S 类，易感者 (Susceptible)，指未得病者，但缺乏免疫能力，与感染者或潜伏者接触后容易受到感染，初始状态下未感染或潜伏的人口皆为易感者；
   * E 类，潜伏者 (Exposed)，指接触过感染者，染上传染病，但无症状，处于潜伏期，具有传染性，可以传播给 S 类成员，将其变为 E 类成员；
   * I 类，感染者 (Infectious)，指染上传染病且表现出症状的人，可以传播给 S 类成员，将其变为 E 类成员；
   * R 类，康复者 (Recovered)，指被隔离或因病愈而具有免疫力的人，状态不再改变；
   * D类，死者(Dead)，指染病而死的人，不再传染其他人。
3. 易感者接触潜伏者或感染者有可能被感染；潜伏者有概率变为感染者；感染者有概率自愈（成为免疫者），也有概率死亡（成为死者）。
4. 每个状态转移事件均为独立事件。

### 模型建立

#### SEIR传染病传播模型

假设在m*n的2维空间中，存在有效活动空间D，总人口P在D范围内活动

初始状态：所有人口均健康，为易感者S类，且随机分布在空间D中。

开始条件：随机抽取一人，使其感染疾病，转变为I类感染者

状态转移规则

1. 易感者
   * 单位时间内每接触一个感染者，有α1的概率变为潜伏者，1-α1的概率维持易感状态
   * 单位时间内每接触一个潜伏者，有α2的概率变为潜伏者，1-α2的概率维持易感状态
   * 若单位时间内没有接触感染者或潜伏者，保持易感状态
2. 潜伏者
   * 单位时间内有β的概率变为感染者，有1-β的概率保持潜伏状态
3. 感染者
   * 单位时间内有θ的概率变为治愈者有1-θ的概率保持感染者状态
4. 治愈者
   * 保持治愈状态

状态转移过程如图所示

![状态转移图（没有死亡）](.\graphs\状态转移图（没有死亡）.png)

<center>图？SEIR状态转移图

**接触的定义**

采用R=1的Moore邻域作为接触的判断标准，Moore邻域数学表示如下
$$
N = \{v_i = (v_i^x,v_i^y)||v_i^x-v_0^x|\le R,|v_i^y-v_0^y|\le R,(v_i^x,v_i^y) \in z^2\}
$$
若一人的邻域中存在其他人则视为接触

#### SEIRD传染病传播模型

与SEIR模型类似，唯一不同在于状态转移规则3

3. 感染者
   * 单位时间内有θ的概率变为治愈者，有γ的概率变为死者，有1-θ-γ的概率保持感染者状态

状态转移过程如图所示

![状态转移图](.\graphs\状态转移图.png)

<center>图？SEIRD状态转移图

### 模型计算

#### 伪代码：

**输入：**

未处理的大不列颠岛地图矩阵Map(x,y)，x为经度方向，y为纬度方向

**初始化：**

配置参数：总迭代周期t，易感者被病人感染率α1，易感者被潜伏者感染率α2，治愈率θ，潜伏者转感染者率β，死亡率γ

设定地图矩阵元素可能的状态：

​	不可达区域 WALL=-1

​	可达且无人区域 NULL=0

​	存在健康的人 HEALTHY=1

​	存在潜伏期的人 INCUB=2

​	存在病人 SICK=3

​	存在具有免疫的人 IMMUNE=4

​						

1、预处理地图矩阵Map，将人可到达区域对应的值设置为NULL，不可到达区域对应的值设置为WALL

2、初始化地图矩阵Map的人口，随机将部分值为NULL的元素修改为HEALTHY

3、随机感染，随机将Map部分值为HEALTHY的元素修改为INCUB

**过程：**

1、随机移动：Map上的人随机朝所在格子周围8个格子移动1次

2、状态转移：依据状态转移规则（参看“模型建立”部分），修改Map(x,y)部分元素的值

**输出：**

包含各状态的人的地图矩阵Map(x,y)

#### 模型计算流程

选取英国地图作为可活动区域（图片像素166*101，其中可活动区域占5371格），以表示所研究的群体免疫与英国相关。选取总人口P = 1000，以求得到与人口位置精确度相匹配的接触率。

取依据论文[1]中的数据，对于第一问，设定参数α1 = 0.3，α2 = 0.3，β = 0.1，θ=0.1，γ=0

程序运行流程如下图所示

![流程图](.\graphs\流程图.png)

<center>图？python元胞自动机运行流程图

### 模型计算结果

##### 1.传染率(正常人被感染的概率)与整个城市居民的感染人数之间的关系：

随着时间的延长，会达到一个稳定的平衡态

当  θ=0.025，α1 = 0.5，α2 = 0.5，β = 0.1，γ=0.005时 部分时刻程序运行截图如下

![](.\graphs\0.1,0.3,0.3,0.1,0(Runtime1).png)![](.\graphs\0.1,0.3,0.3,0.1,0(Runtime2).png)

不同时间下各状态人数的折线图：

![](.\graphs\0.025,0.5,0.5,0.1,0.005.png)

最终各状态人数表格：

| healthy | incub | sick | immune | death |
| ------- | ----- | ---- | ------ | ----- |
| 0       | 0     | 0    | 810    | 190   |

可以看出，当时间超过300个时间单位之后，进入稳定状态，所有人获得了对COVID-19的免疫力



##### 2.几乎全部染病或者疾病基本消失的情况：

当  θ=0.025，α1 = 0.3，α2 = 0.3，β = 0.1，γ=0.005时，几乎所有人染病

![](.\graphs\0.005,0.99,0.99,0.1,0.005(Runtime2).png)

![](.\graphs\0.025,0.3,0.3,0.1,0.005.png)

300时间单位后各状态人数表格：

| healthy | incub | sick | immune | death |
| ------- | ----- | ---- | ------ | ----- |
| 35      | 0     | 40   | 770    | 155   |

当  θ=0.025，α1 = 0.02，α2 = 0.02，β = 0.1，γ=0时，疾病逐渐基本消失

![](.\graphs\0.025,0.02,0.02,0.1,0(500).png)

最终状态人数表格：

| healthy | incub | sick | immune | death |
| ------- | ----- | ---- | ------ | ----- |
| 800     | 0     | 0    | 200    | 0     |

##### 3.治愈率, 死亡率, 以及隔离措施对上面两个问题的影响：

假定发现了一种特效药，将治愈率提高至θ=0.1（原先的四倍）

![](.\graphs\0.1,0.7,0.7,0.1,0.png)

那么，随着时间推移，同样地会进入稳定状态，但是得病人数的峰值会显著下降

同时，我们发现，在提高治愈率但不改变其他参数下，使得所有人感染或者疾病基本消失的传染率几乎不变，仍为0.3与0.02



假定临床采用新的治疗手段，使得COVID-19的致死率降为0

![](.\graphs\0.025,0.1,0.1,0.1,0(500).png)

则在500个时间单位内，感染人数将持续的处在较低位，而大部分人将逐渐获得免疫力

而使得所有人感染或者疾病基本消失的传染率几乎仍为0.3与0.02



假定采取隔离措施，降低感染率α1与α至0.2

![](.\graphs\0.025,0.2,0.2,0.1,0(500).png)

在500个时间单位之后，几乎所有人获得了免疫力，进入了稳定态

同时，隔离措施导致的感染率下降，在足够长的时间内，依然无法避免所有人被感染

### 参考文献

[1]曹盛力,冯沛华,时朋朋.修正SEIR传染病动力学模型应用于湖北省2019冠状病毒病（COVID-19）疫情预测和评估[J/OL].浙江大学学报(医学版):1-13[2020-04-01].http://kns.cnki.net/kcms/detail/33.1248.R.20200303.1722.004.html.

### 附录

